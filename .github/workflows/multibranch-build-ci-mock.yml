name: Mocked Multibranch Pipeline

on:
  push:
    branches:
      - '**'   # alle Branches

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Check commit message for "break"
        run: |
          COMMIT_MSG="$(git log -1 --pretty=%B)"
          echo "Commit message: $COMMIT_MSG"
          if [[ "$COMMIT_MSG" == *"break"* ]]; then
            echo "Commit message contains 'break'. Aborting pipeline."
            exit 1
          fi

      - name: Build
        run: echo "Mock build step"

      - name: Test
        run: echo "Mock test step"

      - name: Publish
        if: github.ref == 'refs/heads/main' || startsWith(github.ref, 'refs/heads/release')
        run: echo "Mock publish step (only for main/release)"
